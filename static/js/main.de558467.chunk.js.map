{"version":3,"sources":["components/TopPanel/Button.jsx","components/TopPanel/TopPanel.jsx","components/BottomPanel/SizeBlock.jsx","components/BottomPanel/ColorCircle.jsx","components/BottomPanel/ColorBlock.jsx","components/BottomPanel/ToggleIcon.jsx","components/BottomPanel/ModeArea.jsx","components/BottomPanel/BottomPanel.jsx","components/Canvas.jsx","App.jsx","index.js"],"names":["Wrapper","styled","div","_templateObject","Container","_templateObject2","_ref","disabled","css2","_templateObject3","React","memo","_ref2","_ref2$Icon","Icon","_ref2$text","text","_ref2$onClick","onClick","f","_ref2$disabled","react_default","a","createElement","size","className","TopPanel_templateObject","props","open","CollapseButton","TopPanel_templateObject2","TopPannel","_ref$onClickClearBtn","onClickClearBtn","onClickRedoBtn","onClickUndoBtn","onClickSaveBtn","_ref$canRedo","canRedo","_ref$canUndo","canUndo","_useState","useState","_useState2","Object","slicedToArray","setOpen","TopPanel_Wrapper","TopPanel_Button","MdSave","MdFullscreen","MdUndo","MdRedo","md","SizeBlock_templateObject","setSize","onCheckSize","inputRef","useRef","useEffect","input","current","selectionStart","selectionEnd","value","length","SizeBlock_Wrapper","type","ref","onChange","e","target","onBlur","onKeyPress","key","onKeyDown","isNaN","keyCode","Number","Circle","ColorCircle_templateObject","color","ColorCircle","_ref3","_ref3$select","select","_ref3$color","_ref3$onClick","ColorBlock_templateObject","ColorBlock","selectColor","setSelectColor","setColor","ColorBlock_Wrapper","map","idx","BottomPanel_ColorCircle","ToggleIcon_templateObject","ToggleIcon","_ref$onClick","_ref$open","ToggleIcon_Wrapper","ModeArea_templateObject","ModeArea","mode","setMode","ModeArea_Wrapper","MdBrush","modeName","FaEraser","MdBorderClear","concat","BottomPanel_templateObject","BottomPanel","Fragment","BottomPanel_Wrapper","BottomPanel_SizeBlock","BottomPanel_ColorBlock","backgroundColor","Canvas","canvas","Canvas_templateObject","Window","Canvas_templateObject2","makePicture","dataImg","Promise","resolve","reject","canvasPic","Image","src","onload","onerror","renderLoop","ctx","canUpdate","mouseX","mouseY","updateKey","resizeCanvas","_canvas$getBoundingCl","getBoundingClientRect","width","height","drawCursor","beginPath","strokeStyle","lineWidth","lineJoin","lineCap","moveTo","lineTo","stroke","arc","Math","PI","fillStyle","fill","closePath","update","cancelAnimationFrame","requestAnimationFrame","drawImage","fillRect","init","newCanvas","getContext","setCursor","x","y","setSpec","spec","setDataImg","newDataImg","getDataImg","stopUpdate","startUpdate","clearCanvas","checkSize","oldSize","newSize","tmpSize","parseInt","oriX","oriY","memoryCanvas","document","copyCanvas","memoryCtx","copyCtx","components_Canvas","canvasRef","downloadTagRef","drawing","setDrawing","_useState3","_useState4","_useState5","_useState6","_useState7","_useState8","history","setHistory","_useState9","_useState10","historyIdx","setHistoryIdx","_useState11","_useState12","_useState13","_useState14","oldWin","setOldWin","_useState15","h","w","_useState16","win","setWin","_useState17","_useState18","showWin","setShowWin","_useState19","_useState20","isCreateWindow","setIsCreateWindow","_useState21","_useState22","isAdjusteWindow","setIsAdjusteWindow","canvasStyle","cursor","windowStyle","left","top","display","_makeTmpDataImg","asyncToGenerator","regenerator_default","mark","_callee","newWin","dataPic","copyImgData","copyPic","wrap","_context","prev","next","abrupt","sent","getImageData","putImageData","toDataURL","clearRect","stop","this","apply","arguments","pushHistory","oldHistory","slice","toConsumableArray","onWindowMouseMove","min","clientX","clientY","abs","onWindowMouseUp","window","addEventListener","removeEventListener","objectSpread","_x","makeTmpDataImg","style","onMouseDown","correctSize","newColor","_ref$color","_ref$size","drawLineStart","onMouseMove","drawLine","onMouseUp","onMouseLeave","TopPanel","dataURL","aTag","href","download","Date","toISOString","click","BottomPanel_BottomPanel","hidden","GlobalStyle","createGlobalStyle","App_templateObject","App","ReactDOM","render","src_App","getElementById"],"mappings":"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","file":"static/js/main.de558467.chunk.js","sourcesContent":["import React from 'react';\nimport styled, { css as css2 } from 'styled-components';\n\nconst Wrapper = styled.div`\n  display: inline-block;\n  /* background: pink; */\n  padding: 14px 0;\n  margin: 0 14px;\n`;\n\nconst Container = styled.div`\n  /* background: skyblue; */\n  padding: 2px 0;\n  padding-right: 8px;\n  padding-left: 2px;\n  border-radius: 10px;\n  cursor: pointer;\n  transition: background 300ms;\n  &:hover {\n    background: #e8e8e8;\n  }\n\n  > * {\n    vertical-align: middle;\n  }\n  .btn-text {\n    margin-left: 4px;\n  }\n\n  ${({ disabled }) =>\n    disabled &&\n    css2`\n    color: grey;\n    pointer-events: none;\n  `};\n`;\n\nfunction Button({\n  Icon = () => null,\n  text = '',\n  onClick = f => f,\n  disabled = false\n}) {\n  return (\n    <Wrapper>\n      <Container onClick={onClick} disabled={disabled}>\n        <Icon size={48} />\n        <span className=\"btn-text\">{text}</span>\n      </Container>\n    </Wrapper>\n  );\n}\n\nexport default React.memo(Button);\n","import React, { useState } from 'react';\nimport styled from 'styled-components';\nimport {\n  MdSave,\n  MdFullscreen,\n  MdRedo,\n  MdUndo,\n  MdKeyboardArrowUp\n} from 'react-icons/md';\nimport Button from './Button';\n\nconst Wrapper = styled.div`\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  background: white;\n  text-align: center;\n  transform: translateY(${props => (props.open ? '0' : '-100%')});\n  transition: 600ms;\n\n  > * {\n    vertical-align: middle;\n  }\n`;\n\nconst CollapseButton = styled.div`\n  width: 56px;\n  height: 56px;\n  position: absolute;\n  z-index: -1;\n  left: 50%;\n  margin-left: -28px;\n  bottom: -28px;\n  background: white;\n  border-radius: 100%;\n  text-align: center;\n  line-height: 56px;\n  cursor: pointer;\n\n  > * {\n    margin-bottom: -20px;\n    transform: rotate(${props => (props.open ? '0' : '-180')}deg);\n    transition: transform 600ms;\n  }\n`;\n\nfunction TopPannel({\n  onClickClearBtn = f => f,\n  onClickRedoBtn,\n  onClickUndoBtn,\n  onClickSaveBtn,\n  canRedo = false,\n  canUndo = false\n}) {\n  const [open, setOpen] = useState(true);\n  const togglePanel = () => setOpen(!open);\n\n  return (\n    <Wrapper open={open}>\n      <Button Icon={MdSave} text=\"SAVE\" onClick={onClickSaveBtn} />\n      <Button Icon={MdFullscreen} text=\"CLEAR ALL\" onClick={onClickClearBtn} />\n      <Button\n        Icon={MdUndo}\n        text=\"UNDO\"\n        onClick={onClickUndoBtn}\n        disabled={!canUndo}\n      />\n      <Button\n        Icon={MdRedo}\n        text=\"REDO\"\n        onClick={onClickRedoBtn}\n        disabled={!canRedo}\n      />\n      <CollapseButton open={open} onClick={togglePanel}>\n        <MdKeyboardArrowUp size={24} />\n      </CollapseButton>\n    </Wrapper>\n  );\n}\n\nexport default TopPannel;\n","import React, { useRef, useEffect } from 'react';\nimport styled from 'styled-components';\n\nconst Wrapper = styled.div`\n  /* background: pink; */\n  display: inline-flex;\n  align-items: center;\n\n  input {\n    margin: 0 8px 0 16px;\n    border: none;\n    outline: none;\n    height: 100%;\n    text-align: center;\n    font-size: 20px;\n    width: 74px;\n    background: #e8e8e8;\n    border-radius: 24px;\n  }\n\n  span {\n    font-size: 20px;\n  }\n`;\n\nfunction SizeBlock({ size, setSize, onCheckSize }) {\n  const inputRef = useRef(null);\n\n  function onKeyPress(e) {\n    if (e.key === 'Enter') {\n      onCheckSize();\n    }\n  }\n\n  function onKeyDown(e) {\n    if (isNaN(size)) {\n      return;\n    }\n\n    if (e.keyCode === 38) {\n      return setSize(Number(size) + 1);\n    }\n\n    if (e.keyCode === 40) {\n      return setSize(Number(size) - 1);\n    }\n  }\n\n  useEffect(() => {\n    const input = inputRef.current;\n    input.selectionStart = input.selectionEnd = input.value.length;\n  });\n\n  return (\n    <Wrapper>\n      <span>SIZE:</span>\n      <input\n        type=\"text\"\n        ref={inputRef}\n        value={size}\n        onChange={e => setSize(e.target.value)}\n        onBlur={onCheckSize}\n        onKeyPress={onKeyPress}\n        onKeyDown={onKeyDown}\n      />\n      <span>px</span>\n    </Wrapper>\n  );\n}\n\nexport default React.memo(SizeBlock);\n","import React from 'react';\nimport styled from 'styled-components';\nimport { MdDone } from 'react-icons/md';\n\nconst Circle = styled.div`\n  width: 48px;\n  height: 48px;\n  border: solid 2px;\n  background: ${props => props.color};\n  border-color: ${({ color }) => {\n    if (color === '#fff' || color === '#ffffff' || color === 'white')\n      return '#000';\n    return color;\n  }};\n  border-radius: 50%;\n  margin-right: 8px;\n  &:last-child {\n    margin-right: 0;\n  }\n  text-align: center;\n  line-height: 48px;\n  color: ${({ color }) => {\n    if (color === '#000' || color === '#000000' || color === 'black') {\n      return '#fff';\n    }\n    return '#000';\n  }};\n  cursor: pointer;\n`;\n\nfunction ColorCircle({ select = false, color = '#fff', onClick = f => f }) {\n  return (\n    <Circle color={color} onClick={onClick}>\n      {select && <MdDone />}\n    </Circle>\n  );\n}\n\nexport default ColorCircle;\n","import React from 'react';\nimport styled from 'styled-components';\nimport ColorCircle from './ColorCircle.jsx';\n\nconst Wrapper = styled.div`\n  /* background: pink; */\n  display: inline-flex;\n  align-items: center;\n  font-size: 20px;\n  span {\n    margin-right: 16px;\n  }\n`;\n\nfunction ColorBlock({ color: selectColor, setColor: setSelectColor }) {\n  return (\n    <Wrapper>\n      <span>COLOR:</span>\n      {['#ffffff', '#000000', '#9BFFCD', '#00CC99', '#01936F'].map(\n        (color, idx) => (\n          <ColorCircle\n            select={color === selectColor}\n            color={color}\n            key={idx}\n            onClick={() => setSelectColor(color)}\n          />\n        )\n      )}\n    </Wrapper>\n  );\n}\n\nexport default ColorBlock;\n","import React from 'react';\nimport styled from 'styled-components';\nimport { MdKeyboardArrowDown, MdBrush } from 'react-icons/md';\n\nconst Wrapper = styled.div`\n  position: fixed;\n  z-index: 0;\n  width: 56px;\n  height: 56px;\n  left: 50%;\n  margin-left: -28px;\n\n  bottom: ${props => (props.open ? '120px' : '68px')};\n  @media (max-width: 888px) {\n    bottom: ${props => (props.open ? '241px' : '68px')};\n  }\n\n  margin-bottom: -28px;\n  background: white;\n  border-radius: 100%;\n  text-align: center;\n  line-height: 56px;\n  cursor: pointer;\n  transition: all 600ms;\n  box-shadow: 0px 4px 16px rgba(0, 0, 0, 0.16);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  > * {\n    transition: all 600ms;\n    line-height: 56px;\n  }\n\n  .arrow-down-icon {\n    position: relative;\n    top: ${props => (props.open ? '-10px' : '0px')};\n    opacity: ${props => (props.open ? '1' : '0')};\n  }\n\n  .brush-icon {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    opacity: ${props => (props.open ? '0' : '1')};\n  }\n`;\n\nexport default ({ onClick = f => f, open = true }) => (\n  <Wrapper onClick={onClick} open={open}>\n    <MdKeyboardArrowDown size={24} className=\"arrow-down-icon\" />\n    <MdBrush size={24} className=\"brush-icon\" />\n  </Wrapper>\n);\n","import React from 'react';\nimport styled from 'styled-components';\nimport { MdBrush, MdBorderClear } from 'react-icons/md';\nimport { FaEraser } from 'react-icons/fa';\n\nconst Wrapper = styled.div`\n  display: inline-flex;\n  /* background: grey; */\n  height: auto !important;\n  white-space: nowrap;\n\n  > * {\n    margin-left: 10px;\n    padding: 2px;\n    border-radius: 10px;\n    &:first-child {\n      margin-left: 0;\n    }\n\n    &:hover {\n      background: #e8e8e8;\n    }\n\n    /* background: ${props => (props.select ? 'grey' : 'pink')}; */\n    cursor: pointer;\n    &.select {\n      background: lightgray;\n    }\n  }\n`;\n\nexport default ({ mode, setMode }) => {\n  return (\n    <Wrapper>\n      {[\n        { Icon: MdBrush, modeName: 'mode_draw' },\n        { Icon: FaEraser, modeName: 'mode_eraser' },\n        { Icon: MdBorderClear, modeName: 'mode_window' }\n      ].map(({ Icon, modeName }) => (\n        <Icon\n          key={modeName}\n          size={52}\n          className={`${modeName === mode ? 'select' : ''}`}\n          onClick={() => setMode(modeName)}\n        />\n      ))}\n    </Wrapper>\n  );\n};\n","import React, { useState } from 'react';\nimport styled from 'styled-components';\nimport SizeBlock from './SizeBlock.jsx';\nimport ColorBlock from './ColorBlock.jsx';\nimport ToggleIcon from './ToggleIcon';\nimport ModeArea from './ModeArea';\n\nconst Wrapper = styled.div`\n  position: fixed;\n  z-index: 1;\n  bottom: 40px;\n  left: 50%;\n  transform: ${props =>\n    props.open ? 'translate(-50%, 0)' : 'translate(-50%, calc(100% + 40px))'};\n  transition: transform 600ms;\n  background: white;\n  box-shadow: 0px 4px 16px rgba(0, 0, 0, 0.16);\n  border-radius: 50px;\n  padding: 16px 40px;\n  white-space: nowrap;\n\n  > * {\n    height: 48px;\n    vertical-align: middle;\n    &:nth-child(n + 2) {\n      margin-left: 40px;\n    }\n  }\n\n  @media (max-width: 888px) {\n    white-space: pre-wrap;\n    padding: 16px 24px;\n\n    > * {\n      display: flex;\n\n      &:nth-child(n + 2) {\n        margin-left: 0px;\n        margin-top: 10px;\n      }\n    }\n  }\n`;\n\nfunction BottomPanel({\n  size,\n  setSize,\n  onCheckSize,\n  color,\n  setColor,\n  mode,\n  setMode\n}) {\n  const [open, setOpen] = useState(true);\n  const onTogglePanel = () => setOpen(!open);\n\n  return (\n    <>\n      <Wrapper open={open}>\n        <ModeArea mode={mode} setMode={setMode} />\n        <SizeBlock size={size} onCheckSize={onCheckSize} setSize={setSize} />\n        <ColorBlock color={color} setColor={setColor} />\n      </Wrapper>\n      <ToggleIcon open={open} onClick={onTogglePanel} />\n    </>\n  );\n}\n\nexport default BottomPanel;\n","import React, { useRef, useEffect, useState } from 'react';\nimport styled from 'styled-components';\nimport TopPanel from './TopPanel/TopPanel.jsx';\nimport BottomPanel from './BottomPanel/BottomPanel.jsx';\n\nconst backgroundColor = '#e8e8e8';\n\nconst Canvas = styled.canvas`\n  width: 100%;\n  height: 100%;\n  background: #e8e8e8;\n  cursor: none;\n`;\n\nconst Window = styled.div`\n  border: dashed 3px blue;\n  position: absolute;\n  background: rgba(0, 0, 255, 0.1);\n  cursor: move;\n`;\n\nconst makePicture = dataImg =>\n  new Promise((resolve, reject) => {\n    let canvasPic = new Image();\n    canvasPic.src = dataImg;\n    canvasPic.onload = function() {\n      resolve(canvasPic);\n    };\n    canvasPic.onerror = reject;\n  });\n\nconst renderLoop = (() => {\n  let canvas = null;\n  let ctx = null;\n  let dataImg = null;\n  let canUpdate = true;\n  let mode = 'mode_draw';\n  let mouseX = -100;\n  let mouseY = -100;\n  let color = '#000';\n  let size = 10;\n  let updateKey = null;\n\n  function resizeCanvas() {\n    const { width, height } = canvas.getBoundingClientRect();\n    canvas.width = width;\n    canvas.height = height;\n  }\n\n  function drawCursor() {\n    if (mode === 'mode_draw') {\n      ctx.beginPath();\n      ctx.strokeStyle = color;\n      ctx.lineWidth = size;\n      ctx.lineJoin = 'round';\n      ctx.lineCap = 'round';\n      ctx.moveTo(mouseX, mouseY);\n      ctx.lineTo(mouseX, mouseY);\n      ctx.stroke();\n      return;\n    }\n\n    if (mode === 'mode_eraser') {\n      ctx.beginPath();\n      ctx.arc(mouseX, mouseY, size / 2, 0, Math.PI * 2);\n      ctx.fillStyle = 'whitesmoke';\n      ctx.fill();\n      ctx.closePath();\n      return;\n    }\n  }\n\n  function update() {\n    if (!canUpdate) {\n      cancelAnimationFrame(updateKey);\n      updateKey = requestAnimationFrame(update);\n      return;\n    }\n    // console.log('u');\n    if (dataImg) {\n      let canvasPic = new Image();\n      canvasPic.src = dataImg;\n      canvasPic.onload = function() {\n        resizeCanvas();\n        ctx.drawImage(canvasPic, 0, 0);\n        drawCursor();\n        cancelAnimationFrame(updateKey);\n        updateKey = requestAnimationFrame(update);\n      };\n    } else {\n      resizeCanvas();\n      ctx.fillStyle = backgroundColor;\n      ctx.fillRect(0, 0, canvas.width, canvas.height);\n      drawCursor();\n      cancelAnimationFrame(updateKey);\n      updateKey = requestAnimationFrame(update);\n    }\n  }\n\n  return {\n    init(newCanvas) {\n      canvas = newCanvas;\n      ctx = canvas.getContext('2d');\n      update();\n    },\n    setCursor(x, y) {\n      mouseX = x;\n      mouseY = y;\n    },\n    setSpec(spec) {\n      color = spec.color;\n      size = spec.size;\n      mode = spec.mode;\n    },\n    setDataImg(newDataImg) {\n      dataImg = newDataImg;\n    },\n    getDataImg() {\n      return dataImg;\n    },\n    stopUpdate() {\n      canUpdate = false;\n    },\n    startUpdate() {\n      canUpdate = true;\n    }\n  };\n})();\n\nfunction drawLineStart({ canvas, x, y, color = '#000', size = 10 }) {\n  const ctx = canvas.getContext('2d');\n  ctx.beginPath();\n  ctx.strokeStyle = color;\n  ctx.lineWidth = size;\n  ctx.lineJoin = 'round';\n  ctx.lineCap = 'round';\n  ctx.moveTo(x, y);\n  ctx.lineTo(x, y);\n  ctx.stroke();\n}\n\nfunction drawLine({ canvas, x, y, color, size }) {\n  const ctx = canvas.getContext('2d');\n  ctx.strokeStyle = color;\n  ctx.lineWidth = size;\n  ctx.lineJoin = 'round';\n  ctx.lineCap = 'round';\n  ctx.lineTo(x, y);\n  ctx.stroke();\n}\n\nfunction clearCanvas({ canvas }) {\n  const ctx = canvas.getContext('2d');\n  // ctx.clearRect(0, 0, canvas.width, canvas.height);\n  ctx.fillStyle = backgroundColor;\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\n}\n\nconst checkSize = (() => {\n  let oldSize = null;\n  return newSize => {\n    if (null === oldSize) {\n      oldSize = newSize;\n      return oldSize;\n    }\n    const tmpSize = parseInt(newSize, 10);\n    if (isNaN(tmpSize)) {\n      return oldSize;\n    }\n    if (tmpSize < 1) {\n      oldSize = 1;\n    } else {\n      oldSize = tmpSize;\n    }\n    return oldSize;\n  };\n})();\n\nlet oriX = 0;\nlet oriY = 0;\nconst memoryCanvas = document.createElement('canvas');\nconst copyCanvas = document.createElement('canvas');\nconst memoryCtx = memoryCanvas.getContext('2d');\nconst copyCtx = copyCanvas.getContext('2d');\nexport default () => {\n  const canvasRef = useRef(null);\n  const downloadTagRef = useRef(null);\n  const [drawing, setDrawing] = useState(false);\n  const [size, setSize] = useState(20);\n  const [color, setColor] = useState('#000000');\n  const [history, setHistory] = useState([]);\n  const [historyIdx, setHistoryIdx] = useState(-1);\n  const [mode, setMode] = useState('mode_draw');\n\n  const [oldWin, setOldWin] = useState(null);\n  const [win, setWin] = useState({ x: 0, y: 0, h: 0, w: 0 });\n  const [showWin, setShowWin] = useState(false);\n  const [isCreateWindow, setIsCreateWindow] = useState(false);\n  const [isAdjusteWindow, setIsAdjusteWindow] = useState(false);\n\n  // console.log({ history, historyIdx });\n\n  // compute update\n  const canRedo = history.length > historyIdx + 1;\n  const canUndo = historyIdx > -1;\n  const canvasStyle = {\n    cursor: mode === 'mode_window' ? 'crosshair' : 'none'\n  };\n  const windowStyle = {\n    left: win.x,\n    top: win.y,\n    width: win.w,\n    height: win.h,\n    display: showWin ? 'block' : 'none'\n  };\n\n  // Init RenderLoop\n  useEffect(() => {\n    renderLoop.setSpec({ size, color, mode });\n    renderLoop.init(canvasRef.current);\n  }, []);\n\n  // Update RenderLoop Spec\n  useEffect(() => {\n    renderLoop.setSpec({ size, color, mode });\n  }, [size, color, mode]);\n\n  // Watch mode\n  useEffect(() => {\n    setShowWin(false);\n  }, [mode]);\n\n  // Watch isCreateWindow\n  useEffect(() => {\n    function onWindowMouseMove(e) {\n      if (isCreateWindow) {\n        let x = Math.min(win.x, e.clientX);\n        let y = Math.min(win.y, e.clientY);\n        let w = Math.abs(win.x - e.clientX);\n        let h = Math.abs(win.y - e.clientY);\n        setWin({ x, y, w, h });\n        setShowWin(true);\n      }\n    }\n    function onWindowMouseUp() {\n      if (isCreateWindow) {\n        setIsCreateWindow(false);\n      }\n    }\n    window.addEventListener('mousemove', onWindowMouseMove);\n    window.addEventListener('mouseup', onWindowMouseUp);\n    return () => {\n      window.removeEventListener('mousemove', onWindowMouseMove);\n      window.removeEventListener('mouseup', onWindowMouseUp);\n    };\n  }, [isCreateWindow]);\n\n  // Watch isAdjustWIndow\n  useEffect(() => {\n    function onWindowMouseMove(e) {\n      if (isAdjusteWindow) {\n        let x = win.x + e.clientX - oriX;\n        let y = win.y + e.clientY - oriY;\n        const newWin = { ...win, x, y };\n        setWin(newWin);\n        makeTmpDataImg(newWin);\n      }\n    }\n    function onWindowMouseUp() {\n      if (isAdjusteWindow) {\n        setIsAdjusteWindow(false);\n        const dataImg = renderLoop.getDataImg();\n        if (dataImg) {\n          pushHistory(dataImg);\n        }\n      }\n    }\n    window.addEventListener('mousemove', onWindowMouseMove);\n    window.addEventListener('mouseup', onWindowMouseUp);\n    return () => {\n      window.removeEventListener('mousemove', onWindowMouseMove);\n      window.removeEventListener('mouseup', onWindowMouseUp);\n    };\n  }, [isAdjusteWindow]);\n\n  async function makeTmpDataImg(newWin) {\n    const dataImg = history[historyIdx];\n    if (!dataImg) return false;\n    // console.log(dataImg);\n    const dataPic = await makePicture(dataImg);\n    const canvas = canvasRef.current;\n    memoryCanvas.width = canvas.width;\n    memoryCanvas.height = canvas.height;\n    memoryCtx.drawImage(dataPic, 0, 0);\n    // copy\n    const copyImgData = memoryCtx.getImageData(\n      oldWin.x,\n      oldWin.y,\n      oldWin.w,\n      oldWin.h\n    );\n    copyCanvas.width = oldWin.w;\n    copyCanvas.height = oldWin.h;\n    copyCtx.putImageData(copyImgData, 0, 0);\n    const copyPic = await makePicture(copyCanvas.toDataURL());\n    // clear\n    memoryCtx.clearRect(oldWin.x, oldWin.y, oldWin.w, oldWin.h);\n    // paste\n    memoryCtx.drawImage(\n      copyPic,\n      0,\n      0,\n      oldWin.w,\n      oldWin.h,\n      newWin.x,\n      newWin.y,\n      newWin.w,\n      newWin.h\n    );\n    // set\n    renderLoop.setDataImg(memoryCanvas.toDataURL());\n    // console.log(memoryCanvas.toDataURL());\n  }\n\n  function pushHistory(newDataImg) {\n    let oldHistory = history.slice(0, historyIdx + 1);\n    setHistory([...oldHistory, newDataImg]);\n    setHistoryIdx(historyIdx + 1);\n  }\n\n  function onWinMouseDown(e) {\n    oriX = e.clientX;\n    oriY = e.clientY;\n    setOldWin({ ...win });\n    setIsAdjusteWindow(true);\n  }\n\n  function onCanvasMouseDown(e) {\n    if (mode === 'mode_window') {\n      setIsCreateWindow(true);\n      setWin({ x: e.clientX, y: e.clientY, w: 3, h: 3 });\n      setShowWin(false);\n      return;\n    }\n\n    setDrawing(true);\n    renderLoop.stopUpdate();\n\n    const correctSize = checkSize(size);\n    setSize(correctSize);\n    const newColor = mode === 'mode_draw' ? color : backgroundColor;\n    drawLineStart({\n      canvas: canvasRef.current,\n      x: e.clientX,\n      y: e.clientY,\n      color: newColor,\n      size: correctSize\n    });\n  }\n\n  function onCanvasMouseMove(e) {\n    if (mode === 'mode_window') {\n      return false;\n    }\n\n    const x = e.clientX;\n    const y = e.clientY;\n    if (drawing) {\n      const correctSize = checkSize(size);\n      if (size !== correctSize) {\n        setSize(correctSize);\n      }\n      const newColor = mode === 'mode_draw' ? color : backgroundColor;\n      drawLine({\n        canvas: canvasRef.current,\n        x,\n        y,\n        color: newColor,\n        size: correctSize\n      });\n    } else {\n      renderLoop.setCursor(x, y);\n    }\n  }\n\n  function onCanvasMouseUp() {\n    if (mode === 'mode_window') {\n      return false;\n    }\n\n    let newDataImg = canvasRef.current.toDataURL();\n    pushHistory(newDataImg);\n    renderLoop.setDataImg(newDataImg);\n    renderLoop.startUpdate();\n    setDrawing(false);\n  }\n\n  function onCanvasMouseLeave() {\n    renderLoop.setCursor(-100, -100);\n  }\n\n  function onClickClearBtn() {\n    clearCanvas({ canvas: canvasRef.current });\n    let newDataImg = canvasRef.current.toDataURL();\n    pushHistory(newDataImg);\n    renderLoop.setDataImg(newDataImg);\n  }\n\n  function onCheckSize() {\n    const correctSize = checkSize(size);\n    setSize(correctSize);\n  }\n\n  function onClickUndoBtn() {\n    if (canUndo) {\n      if (historyIdx === 0) {\n        clearCanvas({ canvas: canvasRef.current });\n        let newDataImg = canvasRef.current.toDataURL();\n        renderLoop.setDataImg(newDataImg);\n      } else {\n        const dataImg = history[historyIdx - 1];\n        renderLoop.setDataImg(dataImg);\n      }\n      setHistoryIdx(historyIdx - 1);\n      setShowWin(false);\n    }\n  }\n\n  function onClickRedoBtn() {\n    if (canRedo) {\n      const dataImg = history[historyIdx + 1];\n      renderLoop.setDataImg(dataImg);\n      setHistoryIdx(historyIdx + 1);\n    }\n  }\n\n  function onClickSaveBtn() {\n    const dataURL = canvasRef.current.toDataURL('image/png');\n    const aTag = downloadTagRef.current;\n    aTag.href = dataURL;\n    aTag.download = 'canvas-' + new Date().toISOString() + '.png';\n    aTag.click();\n  }\n\n  return (\n    <>\n      <Window style={windowStyle} onMouseDown={onWinMouseDown} />\n      <Canvas\n        ref={canvasRef}\n        style={canvasStyle}\n        onMouseDown={onCanvasMouseDown}\n        onMouseMove={onCanvasMouseMove}\n        onMouseUp={onCanvasMouseUp}\n        onMouseLeave={onCanvasMouseLeave}\n      />\n      <TopPanel\n        onClickClearBtn={onClickClearBtn}\n        onClickUndoBtn={onClickUndoBtn}\n        onClickRedoBtn={onClickRedoBtn}\n        onClickSaveBtn={onClickSaveBtn}\n        canRedo={canRedo}\n        canUndo={canUndo}\n      />\n      <BottomPanel\n        size={size}\n        setSize={setSize}\n        onCheckSize={onCheckSize}\n        color={color}\n        setColor={setColor}\n        mode={mode}\n        setMode={setMode}\n      />\n      <a\n        href=\"#?file\"\n        style={{ display: 'none' }}\n        hidden={true}\n        ref={downloadTagRef}\n      >\n        Download Link\n      </a>\n    </>\n  );\n};\n","import React from 'react';\nimport { createGlobalStyle } from 'styled-components';\nimport Canvas from './components/Canvas.jsx';\n\nconst GlobalStyle = createGlobalStyle`\n  *, *::before, *::after {\n    box-sizing: border-box;\n  }\n  html, body, #root {\n    height: 100%;\n    margin: 0;\n    padding: 0;\n  }\n  body, input {\n    font-family: 'Open Sans', sans-serif;\n    font-weight: bold;\n  }\n  body {\n    overflow: hidden;\n    user-select: none;\n  }\n`;\n\nfunction App() {\n  return (\n    <>\n      <GlobalStyle />\n      <Canvas />\n    </>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App.jsx';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}